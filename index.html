function genLengthQ(grade) {
            const units = [
                {n: '公里', v: 1000000}, {n: '公尺', v: 1000}, 
                {n: '公分', v: 10}, {n: '毫米', v: 1}
            ];
            let q, ans, type = 'length';
            
            if(grade === '2') {
                // 二年級：公分與毫米的互換 (進位10)
                if (Math.random() > 0.5) {
                    let val = rand(5, 50);
                    q = val + " 公分 = (?) 毫米";
                    ans = val * 10;
                } else {
                    let val = rand(2, 9) * 10 + rand(1, 9);
                    q = val + " 毫米 = (?) 公分 (?) 毫米<br><span class='text-sm'>(請填寫總共多少毫米)</span>";
                    // 這裡改為考：2公分5毫米 = (?) 毫米
                    let cm = rand(2, 9), mm = rand(1, 9);
                    q = cm + " 公分 " + mm + " 毫米 = (?) 毫米";
                    ans = cm * 10 + mm;
                }
            } else if(grade === '3') {
                // 三年級：公尺與公分的互換 (進位100)
                let r = Math.random();
                if (r < 0.33) {
                    let val = rand(2, 15);
                    q = val + " 公尺 = (?) 公分";
                    ans = val * 100;
                } else if (r < 0.66) {
                    let val = rand(200, 900);
                    q = val + " 公分 = (?) 公尺";
                    ans = val / 100; // 剛好整除
                } else {
                    let m = rand(1, 5), cm = rand(1, 99);
                    q = m + " 公尺 " + cm + " 公分 = (?) 公分";
                    ans = m * 100 + cm;
                }
            } else {
                // 四年級：公里與公尺的進階換算 (進位1000)
                let r = Math.random();
                if (r < 0.33) {
                    let val = rand(2, 12);
                    q = val + " 公里 = (?) 公尺";
                    ans = val * 1000;
                } else if (r < 0.66) {
                    let m = rand(1, 9), dm = rand(1, 999);
                    q = m + " 公里 " + dm + " 公尺 = (?) 公尺";
                    ans = m * 1000 + dm;
                } else {
                    // 難度提升：跨單位挑戰
                    let val = rand(1, 5);
                    q = val + " 公尺 = (?) 毫米";
                    ans = val * 1000;
                }
            }
            return { q, ans, type };
        }